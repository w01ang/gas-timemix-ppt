# è®­ç»ƒæ—¥å¿—ä½¿ç”¨æŒ‡å—

## ğŸ“ æ¦‚è¿°

è®­ç»ƒè„šæœ¬ `train_sliding_window.py` ä¼šè‡ªåŠ¨è®°å½•è®­ç»ƒè¿‡ç¨‹ä¸­çš„æ‰€æœ‰æŸå¤±æŒ‡æ ‡åˆ°æ—¥å¿—æ–‡ä»¶ä¸­ã€‚

## ğŸ“ æ—¥å¿—æ–‡ä»¶ç»“æ„

è®­ç»ƒæ—¶ä¼šåœ¨ `logs/<model_id>/` ç›®å½•ä¸‹ç”Ÿæˆä¸¤ä¸ªæ—¥å¿—æ–‡ä»¶ï¼š

```
logs/
â””â”€â”€ <model_id>/
    â”œâ”€â”€ training_loss.csv         # CSVæ ¼å¼çš„è¯¦ç»†æŸå¤±è®°å½•
    â””â”€â”€ training_summary.txt      # æ–‡æœ¬æ ¼å¼çš„è®­ç»ƒæ‘˜è¦
```

## ğŸ“Š æ—¥å¿—æ–‡ä»¶è¯¦è§£

### 1. training_loss.csv

CSVæ ¼å¼çš„è¯¦ç»†æŸå¤±è®°å½•ï¼Œæ¯ä¸ªepochä¸€è¡Œï¼ŒåŒ…å«ä»¥ä¸‹åˆ—ï¼š

| åˆ—å | è¯´æ˜ | ç¤ºä¾‹ |
|------|------|------|
| Epoch | è®­ç»ƒè½®æ¬¡ | 1, 2, 3, ... |
| Train_Loss | è®­ç»ƒæŸå¤± | 0.3386983 |
| Vali_Loss | éªŒè¯æŸå¤± | 0.3731581 |
| Test_Loss | æµ‹è¯•æŸå¤± | 0.4059942 |
| Learning_Rate | å½“å‰å­¦ä¹ ç‡ | 0.0000687410 |
| Time | è®°å½•æ—¶é—´ | 2025-10-10 15:30:45 |

**ç¤ºä¾‹å†…å®¹**ï¼š
```csv
Epoch,Train_Loss,Vali_Loss,Test_Loss,Learning_Rate,Time
1,0.3386983,0.3731581,0.4059942,0.0000687410,2025-10-10 15:30:45
2,0.2468214,0.3570666,0.3897177,0.0000000022,2025-10-10 15:42:12
...
```

**ç”¨é€”**ï¼š
- å¯ä»¥å¯¼å…¥Excel/Pythonè¿›è¡Œå¯è§†åŒ–åˆ†æ
- ç»˜åˆ¶æŸå¤±æ›²çº¿
- åˆ†æå­¦ä¹ ç‡å˜åŒ–è¶‹åŠ¿

### 2. training_summary.txt

æ–‡æœ¬æ ¼å¼çš„è®­ç»ƒæ‘˜è¦ï¼ŒåŒ…å«ï¼š

**è®­ç»ƒå¼€å§‹ä¿¡æ¯**ï¼š
```
è®­ç»ƒæ—¥å¿— - æ¨¡å‹ID: wellmix_640_160
å¼€å§‹æ—¶é—´: 2025-10-10 15:30:00
================================================================================
```

**æ¯ä¸ªEpochçš„è¯¦ç»†è®°å½•**ï¼š
```
Epoch 1:
  Train Loss: 0.3386983
  Vali Loss:  0.3731581
  Test Loss:  0.4059942
  Learning Rate: 0.0000687410
  Time: 12.82s
--------------------------------------------------------------------------------
```

**è®­ç»ƒç»“æŸä¿¡æ¯**ï¼š
```
================================================================================
è®­ç»ƒå®Œæˆ
ç»“æŸæ—¶é—´: 2025-10-10 18:45:23
æ€»è®­ç»ƒæ—¶é—´: 11523.45s (192.06åˆ†é’Ÿ)
æœ€ä½³Epoch: 87
æœ€ä½³éªŒè¯æŸå¤±: 0.2345678
æ—©åœè§¦å‘: æ˜¯
================================================================================
```

## ğŸš€ ä½¿ç”¨ç¤ºä¾‹

### è®­ç»ƒæ¨¡å‹ï¼ˆè‡ªåŠ¨è®°å½•æ—¥å¿—ï¼‰

```bash
python scripts/train_sliding_window.py \
  --model_id my_model_640_160 \
  --input_len 640 \
  --output_len 160 \
  --train_epochs 100 \
  --use_gpu
```

è®­ç»ƒå®Œæˆåï¼Œæ—¥å¿—ä¼šè‡ªåŠ¨ä¿å­˜åœ¨ï¼š
- `logs/my_model_640_160/training_loss.csv`
- `logs/my_model_640_160/training_summary.txt`

### æŸ¥çœ‹æ—¥å¿—

**æŸ¥çœ‹æ–‡æœ¬æ‘˜è¦**ï¼š
```bash
cat logs/my_model_640_160/training_summary.txt
```

**æŸ¥çœ‹CSVï¼ˆå‰10è¡Œï¼‰**ï¼š
```bash
head -11 logs/my_model_640_160/training_loss.csv
```

**æŸ¥çœ‹æœ€åå‡ ä¸ªepoch**ï¼š
```bash
tail -20 logs/my_model_640_160/training_summary.txt
```

## ğŸ“ˆ åˆ†ææŸå¤±æ›²çº¿

### ä½¿ç”¨Pythonç»˜åˆ¶æŸå¤±æ›²çº¿

```python
import pandas as pd
import matplotlib.pyplot as plt

# è¯»å–æ—¥å¿—
df = pd.read_csv('logs/my_model_640_160/training_loss.csv')

# ç»˜åˆ¶æŸå¤±æ›²çº¿
plt.figure(figsize=(12, 6))

plt.plot(df['Epoch'], df['Train_Loss'], label='Train Loss', marker='o')
plt.plot(df['Epoch'], df['Vali_Loss'], label='Validation Loss', marker='s')
plt.plot(df['Epoch'], df['Test_Loss'], label='Test Loss', marker='^')

plt.xlabel('Epoch')
plt.ylabel('Loss')
plt.title('Training Loss Curves')
plt.legend()
plt.grid(True, alpha=0.3)
plt.tight_layout()
plt.savefig('loss_curve.png', dpi=300)
plt.show()
```

### ä½¿ç”¨Excelåˆ†æ

1. æ‰“å¼€ `training_loss.csv`
2. é€‰ä¸­æ•°æ®åˆ—
3. æ’å…¥ â†’ å›¾è¡¨ â†’ æŠ˜çº¿å›¾
4. å¯ä»¥åˆ†æï¼š
   - æŸå¤±ä¸‹é™è¶‹åŠ¿
   - æ˜¯å¦è¿‡æ‹Ÿåˆï¼ˆtrain lossä¸‹é™ä½†vali lossä¸Šå‡ï¼‰
   - æœ€ä½³epochä½ç½®
   - å­¦ä¹ ç‡å˜åŒ–

## ğŸ” æ—¥å¿—ä¿¡æ¯è§£è¯»

### æŸå¤±å€¼å«ä¹‰

å‡è®¾æ•°æ®ç»è¿‡æ ‡å‡†åŒ–ï¼ˆå‡å€¼0ï¼Œæ ‡å‡†å·®1ï¼‰ï¼š

```
Train Loss = 0.3386983
```

è¿™è¡¨ç¤ºï¼š
- **MSEæŸå¤±** = 0.34ï¼ˆå‡æ–¹è¯¯å·®ï¼‰
- **RMSE** â‰ˆ âˆš0.34 â‰ˆ 0.58ï¼ˆå‡æ–¹æ ¹è¯¯å·®ï¼Œçº¦0.58ä¸ªæ ‡å‡†å·®ï¼‰

å¦‚æœåŸå§‹æ•°æ®æ ‡å‡†å·®ä¸º1000ï¼š
```
å®é™…RMSE â‰ˆ 0.58 Ã— 1000 = 580 å•ä½
```

### éªŒè¯æŸå¤± vs æµ‹è¯•æŸå¤±

- **éªŒè¯æŸå¤±ï¼ˆVali Lossï¼‰**ï¼šç”¨äºæ—©åœå†³ç­–
- **æµ‹è¯•æŸå¤±ï¼ˆTest Lossï¼‰**ï¼šç”¨äºè¯„ä¼°æœ€ç»ˆæ€§èƒ½
- ç†æƒ³æƒ…å†µï¼šä¸‰è€…åº”è¯¥æ¥è¿‘
- è¿‡æ‹Ÿåˆï¼šTrain Loss << Vali Loss

### å­¦ä¹ ç‡å˜åŒ–

ä½¿ç”¨ OneCycleLR è°ƒåº¦å™¨ï¼š
- å‰æœŸï¼ˆ0-20%ï¼‰ï¼šå­¦ä¹ ç‡é€æ¸ä¸Šå‡
- ä¸­æœŸï¼ˆ20%-80%ï¼‰ï¼šå­¦ä¹ ç‡ä¿æŒé«˜ä½
- åæœŸï¼ˆ80%-100%ï¼‰ï¼šå­¦ä¹ ç‡å¿«é€Ÿä¸‹é™

## âš ï¸ å¸¸è§é—®é¢˜

### Q1: æ—¥å¿—æ–‡ä»¶åœ¨å“ªé‡Œï¼Ÿ

A: åœ¨ `logs/<model_id>/` ç›®å½•ä¸‹ï¼Œä¸æ¨¡å‹IDåŒåã€‚

### Q2: å¦‚ä½•æŸ¥çœ‹è®­ç»ƒæ˜¯å¦æ—©åœï¼Ÿ

A: æŸ¥çœ‹ `training_summary.txt` æœ€åå‡ è¡Œï¼Œä¼šæ˜¾ç¤º"æ—©åœè§¦å‘: æ˜¯/å¦"ã€‚

### Q3: æŸå¤±çªç„¶å˜å¤§æ€ä¹ˆåŠï¼Ÿ

A: 
1. æ£€æŸ¥å­¦ä¹ ç‡æ˜¯å¦è¿‡å¤§
2. æŸ¥çœ‹æ˜¯å¦æ•°æ®å¼‚å¸¸
3. è€ƒè™‘é™ä½å­¦ä¹ ç‡æˆ–å¢åŠ batch_size

### Q4: å¦‚ä½•å¯¹æ¯”å¤šä¸ªæ¨¡å‹çš„è®­ç»ƒè¿‡ç¨‹ï¼Ÿ

A: ä½¿ç”¨Pythonè„šæœ¬è¯»å–å¤šä¸ªCSVæ–‡ä»¶ï¼Œç»˜åˆ¶åœ¨åŒä¸€å›¾è¡¨ä¸Šï¼š

```python
import pandas as pd
import matplotlib.pyplot as plt

models = ['model1', 'model2', 'model3']

plt.figure(figsize=(12, 6))
for model_id in models:
    df = pd.read_csv(f'logs/{model_id}/training_loss.csv')
    plt.plot(df['Epoch'], df['Vali_Loss'], label=model_id, marker='o')

plt.xlabel('Epoch')
plt.ylabel('Validation Loss')
plt.title('Model Comparison')
plt.legend()
plt.grid(True, alpha=0.3)
plt.show()
```

## ğŸ“š ç›¸å…³æ–‡ä»¶

- **è®­ç»ƒè„šæœ¬**: `scripts/train_sliding_window.py`
- **æ—¥å¿—ç›®å½•**: `logs/`
- **æ¨¡å‹ç›®å½•**: `checkpoints/`
- **å®éªŒé…ç½®**: `experiments/<model_id>/config.json`

## ğŸ’¡ æœ€ä½³å®è·µ

1. **å®šæœŸå¤‡ä»½æ—¥å¿—**ï¼šè®­ç»ƒå®Œæˆåå¤‡ä»½æ—¥å¿—æ–‡ä»¶
2. **åŠæ—¶åˆ†æ**ï¼šè®­ç»ƒè¿‡ç¨‹ä¸­å®šæœŸæŸ¥çœ‹æŸå¤±å˜åŒ–
3. **å¯¹æ¯”å®éªŒ**ï¼šä½¿ç”¨ä¸åŒmodel_idåŒºåˆ†ä¸åŒå®éªŒ
4. **è®°å½•è¯´æ˜**ï¼šåœ¨å®éªŒé…ç½®çš„descriptionå­—æ®µæ·»åŠ å®éªŒè¯´æ˜
5. **å¯è§†åŒ–ç›‘æ§**ï¼šä½¿ç”¨è„šæœ¬å®æ—¶ç»˜åˆ¶æŸå¤±æ›²çº¿

---

**æç¤º**ï¼šæ‰€æœ‰æ—¥å¿—ä¼šè‡ªåŠ¨ç”Ÿæˆï¼Œæ— éœ€æ‰‹åŠ¨åˆ›å»ºæˆ–é…ç½®ï¼

