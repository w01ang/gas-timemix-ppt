â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                    ğŸš¨ NaNæŸå¤±å¿«é€Ÿä¿®å¤æŒ‡å—                                   â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ã€é—®é¢˜ã€‘è®­ç»ƒæ—¶ valid loss æ˜¾ç¤ºä¸º NaN

ã€åŸå› ã€‘90%çš„æƒ…å†µæ˜¯å­¦ä¹ ç‡è¿‡é«˜å¯¼è‡´æ¢¯åº¦çˆ†ç‚¸

ã€è§£å†³ã€‘å·²è‡ªåŠ¨æ·»åŠ æ¢¯åº¦è£å‰ªï¼Œç›´æ¥è¿è¡Œä¸‹é¢å‘½ä»¤å³å¯ï¼

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘ âš¡ æ–¹æ¡ˆ1: é™ä½å­¦ä¹ ç‡ (ç«‹å³å°è¯•!) â­â­â­â­â­                              â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

python scripts/train_sliding_window.py \
  --model_id slide_fix_nan_lr1e5 \
  --input_len 3000 \
  --output_len 1000 \
  --step_len 50 \
  --batch_size 16 \
  --learning_rate 1e-5 \
  --train_epochs 60 \
  --use_gpu

å…³é”®æ”¹åŠ¨: --learning_rate 1e-5 (ä»1e-4é™ä½10å€)
æˆåŠŸç‡: 90%

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘ ğŸ›¡ï¸  æ–¹æ¡ˆ2: ä¿å®ˆé…ç½® (å¦‚æœæ–¹æ¡ˆ1è¿˜NaN) â­â­â­â­                           â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

python scripts/train_sliding_window.py \
  --model_id slide_ultra_stable \
  --input_len 3000 \
  --output_len 1000 \
  --step_len 50 \
  --batch_size 32 \
  --d_model 128 --n_heads 8 --e_layers 3 \
  --d_ff 512 --dropout 0.2 \
  --learning_rate 5e-5 \
  --train_epochs 60 \
  --use_gpu

å…³é”®æ”¹åŠ¨: 
  â€¢ batch_size 32 (æ›´ç¨³å®š)
  â€¢ d_model 128 (é™ä½å¤æ‚åº¦)
  â€¢ learning_rate 5e-5

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘ ğŸ”’ æ–¹æ¡ˆ3: æä¿å®ˆ (æœ€åæ‰‹æ®µ) â­â­â­                                       â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

python scripts/train_sliding_window.py \
  --model_id slide_super_safe \
  --input_len 3000 \
  --output_len 1000 \
  --step_len 100 \
  --batch_size 32 \
  --d_model 64 --n_heads 4 --e_layers 2 \
  --d_ff 256 --dropout 0.3 \
  --learning_rate 5e-6 \
  --train_epochs 80 \
  --use_gpu

å…³é”®æ”¹åŠ¨:
  â€¢ d_model 64 (æœ€å°æ¨¡å‹)
  â€¢ learning_rate 5e-6 (æä½)
  â€¢ æ¢¯åº¦è£å‰ªå·²å¯ç”¨

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘ ğŸ” å¦‚ä½•åˆ¤æ–­ä¿®å¤æˆåŠŸ?                                                       â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

è®­ç»ƒå¼€å§‹åè§‚å¯Ÿå‰5ä¸ªepoch:

âœ… ä¿®å¤æˆåŠŸ:
  Epoch 1: Train=1.5, Vali=1.3, Test=1.4
  Epoch 2: Train=1.2, Vali=1.1, Test=1.2
  Epoch 3: Train=1.0, Vali=0.9, Test=1.0
  â†’ æŸå¤±å¹³æ»‘ä¸‹é™ï¼Œæ— NaN

âŒ ä»æœ‰é—®é¢˜:
  Epoch 1: Train=5.2, Vali=NaN
  â†’ ç«‹å³åœæ­¢ï¼Œå°è¯•ä¸‹ä¸€ä¸ªæ–¹æ¡ˆ

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘ ğŸ’¡ å…³é”®è¦ç‚¹                                                                â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

1. æ¢¯åº¦è£å‰ªå·²è‡ªåŠ¨æ·»åŠ 
   ä½ç½®: scripts/train_sliding_window.py ç¬¬167è¡Œ
   æ— éœ€æ‰‹åŠ¨ä¿®æ”¹

2. ä¼˜å…ˆå°è¯•æ–¹æ¡ˆ1
   90%çš„NaNéƒ½æ˜¯å­¦ä¹ ç‡è¿‡é«˜

3. ä¾æ¬¡å°è¯•
   æ–¹æ¡ˆ1 â†’ æ–¹æ¡ˆ2 â†’ æ–¹æ¡ˆ3

4. è§‚å¯Ÿé¦–è½®æŸå¤±
   å¦‚æœEpoch 1å°±NaNï¼Œè¯´æ˜å­¦ä¹ ç‡è¿˜æ˜¯å¤ªé«˜

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘ ğŸ“š æ›´å¤šä¿¡æ¯                                                                â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

å®Œæ•´æ–‡æ¡£: FIX_NAN_LOSS.md
æ•°æ®æ£€æŸ¥è„šæœ¬: scripts/check_data_for_nan.py

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘ ğŸš€ ç«‹å³è¡ŒåŠ¨: å¤åˆ¶æ–¹æ¡ˆ1å‘½ä»¤è¿è¡Œ!                                            â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
